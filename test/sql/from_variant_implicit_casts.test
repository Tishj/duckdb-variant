# name: test/sql/from_variant_implicit_casts.test
# group: [sql]

require variant

require json

# VARIANT(INT32) -> INTEGER
query I
select ['test', 'hello', 'world'][1::VARIANT::INTEGER]
----
test

# VARIANT(INT32) -> BIGINT
query I
select ['test', 'hello', 'world'][1::VARIANT]
----
test

# VARIANT(INT64) -> BIGINT
query I
select ['test', 'hello', 'world'][1::BIGINT::VARIANT]
----
test

# VARIANT(VARCHAR) -> BOOL
query I
select 'true'::VARIANT::BOOL;
----
true

# VARIANT(OBJECT('a': 'true')) -> STRUCT(a BOOLEAN)
statement error
select {'a': 'true'}::VARIANT::STRUCT(a BOOLEAN);
----
Can't convert VARIANT to 'STRUCT(a BOOLEAN)'

# VARIANT(OBJECT('a': 'true')) -> STRUCT(a BOOLEAN)
query I
select {'a': 'true'}::VARIANT::STRUCT(a BOOLEAN);
----
true
